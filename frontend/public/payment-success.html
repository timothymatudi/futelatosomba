<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Successful - futelatosomba</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container">
            <h1><a href="index.html" style="color: white; text-decoration: none;">futelatosomba</a></h1>
        </div>
    </header>

    <main>
        <section class="container" style="padding: 4rem 0; text-align: center;">
            <div class="card-section" style="max-width: 600px; margin: 0 auto;">
                <div style="font-size: 4rem; color: #28a745; margin-bottom: 1rem;">✓</div>
                <h1 style="color: #28a745; margin-bottom: 1rem;">Payment Successful!</h1>
                <p style="font-size: 1.2rem; color: #666; line-height: 1.8; margin-bottom: 2rem;">
                    Thank you for your generous contribution! Your payment has been processed successfully.
                </p>

                <div id="payment-details" style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem; text-align: left;">
                    <h3 style="color: #333; margin-bottom: 1rem;">Payment Details</h3>
                    <p style="color: #666; margin-bottom: 0.5rem;"><strong>Status:</strong> <span id="payment-status">Processing...</span></p>
                    <p style="color: #666; margin-bottom: 0.5rem;"><strong>Amount:</strong> <span id="payment-amount">-</span></p>
                    <p style="color: #666;"><strong>Date:</strong> <span id="payment-date">-</span></p>
                </div>

                <p style="color: #666; line-height: 1.6; margin-bottom: 2rem;">
                    A confirmation email has been sent to your registered email address. Your contribution will directly support educational and welfare programs for children in need across the Democratic Republic of Congo.
                </p>

                <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                    <a href="index.html" class="donation-button" style="text-decoration: none; display: inline-block;">Return Home</a>
                    <a href="index.html#donation-section" class="donation-button" style="text-decoration: none; display: inline-block; background: #667eea;">Make Another Donation</a>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-bottom" style="text-align: center; padding: 2rem 0;">
                <p style="color: #999;">Copyright © 2025 futelatosomba. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script>
        // Get payment details from URL
        const urlParams = new URLSearchParams(window.location.search);
        const sessionId = urlParams.get('session_id');
        const paymentIntentId = urlParams.get('payment_intent');

        async function loadPaymentDetails() {
            try {
                let endpoint;
                if (sessionId) {
                    endpoint = `${CONFIG.API_BASE_URL}/checkout-session/${sessionId}`;
                } else if (paymentIntentId) {
                    endpoint = `${CONFIG.API_BASE_URL}/payment-status/${paymentIntentId}`;
                } else {
                    // No payment ID found, show generic success
                    document.getElementById('payment-status').textContent = 'Completed';
                    document.getElementById('payment-date').textContent = new Date().toLocaleDateString();
                    return;
                }

                const response = await fetch(endpoint);
                const data = await response.json();

                document.getElementById('payment-status').textContent = data.status || 'Completed';
                document.getElementById('payment-amount').textContent = data.amount_total
                    ? `$${(data.amount_total / 100).toFixed(2)}`
                    : (data.amount ? `$${(data.amount / 100).toFixed(2)}` : '-');
                document.getElementById('payment-date').textContent = new Date().toLocaleDateString();
            } catch (error) {
                console.error('Error loading payment details:', error);
                document.getElementById('payment-status').textContent = 'Completed';
                document.getElementById('payment-date').textContent = new Date().toLocaleDateString();
            }
        }

        loadPaymentDetails();
    </script>
</body>
</html>
